# WordPressプラグイン インストール手順

## 📦 プラグインのインストール方法

### 方法1: WordPress管理画面からアップロード（推奨）

1. **WordPress管理画面にログイン**
   - `https://agent.migi-nanameue.co.jp/wp-admin` にアクセス

2. **プラグイン → 新規追加**
   - 左メニューから「プラグイン」→「新規追加」をクリック

3. **プラグインのアップロード**
   - ページ上部の「プラグインのアップロード」をクリック
   - 「ファイルを選択」をクリック
   - `diagnosis-api-plugin.zip` を選択
   - 「今すぐインストール」をクリック

4. **プラグインの有効化**
   - インストール完了後、「プラグインを有効化」をクリック

### 方法2: FTP/SFTPでアップロード

1. **プラグインフォルダを作成**
   - `wp-content/plugins/` フォルダに `diagnosis-api-plugin` フォルダを作成

2. **ファイルをアップロード**
   - `diagnosis-api-plugin.php` を `wp-content/plugins/diagnosis-api-plugin/` にアップロード

3. **プラグインを有効化**
   - WordPress管理画面 → プラグイン → 「適職診断ツール REST API」を有効化

---

## ✅ インストール確認

### 1. プラグインが有効化されているか確認

- WordPress管理画面 → プラグイン
- 「適職診断ツール REST API」が「有効」になっていることを確認

### 2. REST APIエンドポイントが動作しているか確認

ブラウザで以下のURLにアクセスして確認：

- **セッションIDベース（保存）**: `https://agent.migi-nanameue.co.jp/wp-json/diagnosis/v1/save-result`
  - 405エラーが返れば正常（GETリクエストなので）
  - 404エラーが返ればプラグインが有効化されていない可能性

- **セッションIDベース（取得）**: `https://agent.migi-nanameue.co.jp/wp-json/diagnosis/v1/get-result`
  - 404エラーが返れば正常（データがないため）

- **lineUserIdベース（保存）**: `https://agent.migi-nanameue.co.jp/wp-json/diagnosis/v1/save-result-by-lineuser`
  - 405エラーが返れば正常（GETリクエストなので）

- **lineUserIdベース（取得）**: `https://agent.migi-nanameue.co.jp/wp-json/diagnosis/v1/get-result-by-lineuser`
  - 400エラーが返れば正常（lineUserIdパラメータがないため）

---

## 🔧 トラブルシューティング

### プラグインが有効化できない場合

- **エラーメッセージを確認**
  - WordPress管理画面のエラーメッセージを確認
  - PHPのバージョンが5.6以上か確認

- **ファイルの権限を確認**
  - ファイルが正しくアップロードされているか確認
  - ファイルの読み取り権限があるか確認

### REST APIが動作しない場合

- **パーマリンク設定を確認**
  - WordPress管理画面 → 設定 → パーマリンク設定
  - 「変更を保存」をクリック（リライトルールを更新）

- **プラグインが有効化されているか確認**
  - WordPress管理画面 → プラグイン
  - 「適職診断ツール REST API」が有効になっているか確認

- **WordPressのバージョンを確認**
  - WordPress 4.7以上が必要（REST APIが標準搭載）

---

## 📝 プラグインの無効化・削除

### 無効化

- WordPress管理画面 → プラグイン
- 「適職診断ツール REST API」の「無効化」をクリック

### 削除

1. **プラグインを無効化**
2. **プラグインを削除**
   - 「削除」をクリック
   - または、FTP/SFTPで `wp-content/plugins/diagnosis-api-plugin/` フォルダを削除

**注意**: プラグインを削除しても、保存された診断結果データ（Transient）は24時間有効のまま残ります。

---

## 🎯 次のステップ

プラグインのインストールが完了したら：

1. ✅ プラグインが有効化されていることを確認
2. ✅ REST APIエンドポイントが動作していることを確認
3. ✅ `diagnosis.html` の `WP_API_BASE` が正しいURLになっているか確認
4. ✅ 診断ツールをテストして動作確認

---

## 💡 メリット

プラグイン形式のメリット：

- ✅ **テーマに依存しない**: テーマを変更しても動作し続ける
- ✅ **管理が簡単**: WordPress管理画面から有効化・無効化できる
- ✅ **アップデートが容易**: プラグインファイルを差し替えるだけ
- ✅ **安全**: テーマの `functions.php` を編集する必要がない
- ✅ **削除が簡単**: プラグインを削除するだけで無効化できる


